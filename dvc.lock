schema: '2.0'
stages:
  pull_data_1:
    cmd: python src/pull_data.py pull_data_1 data/db_pull_1.parquet
    deps:
    - path: src/pull_data.py
      md5: 1a42c5257353dba8807288bf70df52d5
      size: 1407
    - path: src/utils/dbconnector.py
      md5: b7188e7cd2f1bbd97582ac4344a12c2b
      size: 1499
    params:
      params.yaml:
        pull_data_1:
          database:
            questdb:
              table_name: prod
              host: docker.great-squeaker.ts.net
              port: 9000
          get_calibrated: true
    outs:
    - path: data/db_pull_1.parquet
      md5: d30e256f1a00d82ece6f07422261055a
      size: 135521717
  resample_1:
    cmd: python src/resample.py resample_1 data/db_pull_1.parquet data/resample_1.parquet
    deps:
    - path: data/db_pull_1.parquet
      md5: d30e256f1a00d82ece6f07422261055a
      size: 135521717
    - path: src/resample.py
      md5: 47f7747f347c028471bf90fd9a88a92e
      size: 1331
    params:
      params.yaml:
        resample_1:
          resample_frequency_hz: 50
          interpolation_method: linear
    outs:
    - path: data/resample_1.parquet
      md5: a967aa3c39663152db3c44fd6c906492
      size: 88337427
  segmentate_1:
    cmd: python src/segmentate.py segmentate_1 data/resample_1.parquet data/segmentate_1.dill
    deps:
    - path: data/resample_1.parquet
      md5: a967aa3c39663152db3c44fd6c906492
      size: 88337427
    - path: src/segmentate.py
      md5: e72b50e7b693805c39be23bcbdf385b2
      size: 2381
    params:
      params.yaml:
        segmentate_1:
          window_len_s: 5
          overlap_percent: 0
    outs:
    - path: data/segmentate_1.dill
      md5: f3c8c1ee0cfa27e9d18b2fd563c2ff2f
      size: 142338896
  correlations_1:
    cmd: python src/correlations.py correlations_1 data/segmentate_1.dill data/correlations_1.parquet
    deps:
    - path: data/segmentate_1.dill
      md5: f3c8c1ee0cfa27e9d18b2fd563c2ff2f
      size: 142338896
    - path: src/correlations.py
      md5: de117acfae881d935236b20cae0a0f9c
      size: 2059
    params:
      params.yaml:
        correlations_1:
          correlation_method: pearson
    outs:
    - path: data/correlations_1.parquet
      md5: 941d8d30c04049e2894d016d09dc8017
      size: 6067695
  filter_bandpass_1:
    cmd: python src/butterworth_filter.py filter_bandpass_1 data/segmentate_1.dill
      data/bandpass_1.dill
    deps:
    - path: data/segmentate_1.dill
      md5: f3c8c1ee0cfa27e9d18b2fd563c2ff2f
      size: 142338896
    - path: src/butterworth_filter.py
      md5: 8e474d21e9a43e5b53f60f582fb99bed
      size: 1247
    - path: src/utils/filters.py
      md5: 21ff1b24705d58d1cd747903ed4b23e1
      size: 1978
    params:
      params.yaml:
        filter_bandpass_1:
          filter_type: bandpass
          order: 3
          lowcut_f_Hz: 0.1
          highcut_f_Hz: 100
    outs:
    - path: data/bandpass_1.dill
      md5: ec535cde7a8495fbec1e845c13f844a6
      size: 223395383
  filter_lowpass_1:
    cmd: python src/butterworth_filter.py filter_lowpass_1 data/segmentate_1.dill
      data/lowpass_1.dill
    deps:
    - path: data/segmentate_1.dill
      md5: f3c8c1ee0cfa27e9d18b2fd563c2ff2f
      size: 142338896
    - path: src/butterworth_filter.py
      md5: 8e474d21e9a43e5b53f60f582fb99bed
      size: 1247
    - path: src/utils/filters.py
      md5: 21ff1b24705d58d1cd747903ed4b23e1
      size: 1978
    params:
      params.yaml:
        filter_lowpass_1:
          filter_type: lowpass
          order: 3
          cutoff_f_Hz: 100
    outs:
    - path: data/lowpass_1.dill
      md5: 783377136ebfc065feeae62d125358f3
      size: 223395383
  train_test_split_1:
    cmd: python src/train_test_split.py train_test_split_1 data/segmentate_1.dill
      data/train_test_split_1.json
    deps:
    - path: data/segmentate_1.dill
      md5: f3c8c1ee0cfa27e9d18b2fd563c2ff2f
      size: 142338896
    - path: src/train_test_split.py
      md5: b94aa69d867a09dfb041010bc043dda8
      size: 2734
    params:
      params.yaml:
        train_test_split_1:
          type: person
          test_ratio: 0.2
          seed: 9458
          stratified: true
    outs:
    - path: data/train_test_split_1.json
      md5: 20a5446519af97f135682be727731a9f
      size: 49755
  std-scale_1:
    cmd: python src/standard-scaler.py std-scale_1 data/db_pull_1.parquet data/standard-scaled_1.parquet
      data/standard-scaler-means_1.csv data/standard-scaler-stds_1.csv
    deps:
    - path: data/db_pull_1.parquet
      md5: d30e256f1a00d82ece6f07422261055a
      size: 135521717
    - path: src/standard-scaler.py
      md5: 18b3064f2598473c85b3d542e47820a6
      size: 694
    outs:
    - path: data/standard-scaled_1.parquet
      md5: a794c90b2265914e36a056dd1396afd3
      size: 183725300
    - path: data/standard-scaler-means_1.csv
      md5: 960c8974f6ff21fee6dfbc4d99e2d4aa
      size: 243
    - path: data/standard-scaler-stds_1.csv
      md5: bf2da9ca0ba4e9513e9c74e8295b4cb9
      size: 224
  moving_average_1:
    cmd: python src/moving_average.py moving_average_1 data/resample_1.parquet data/moving_average_1.parquet
    deps:
    - path: data/resample_1.parquet
      md5: a967aa3c39663152db3c44fd6c906492
      size: 88337427
    - path: src/moving_average.py
      md5: 3553996fb307d301ee83af75a6719e22
      size: 1563
    params:
      params.yaml:
        moving_average_1:
          window_len_s: 0.5
    outs:
    - path: data/moving_average_1.parquet
      md5: 021e41268323658f66ffd048183ec814
      size: 138287096
  min-max-scale_1:
    cmd: python src/min-max-scaler.py min-max-scale_1 data/db_pull_1.parquet data/min-max-scaled_1.parquet
      data/min-max-scaler-maxs_1.csv data/min-max-scaler-mins_1.csv
    deps:
    - path: data/db_pull_1.parquet
      md5: d30e256f1a00d82ece6f07422261055a
      size: 135521717
    - path: src/min-max-scaler.py
      md5: 46c632d843281b71035be8cd7b904d46
      size: 1025
    params:
      params.yaml:
        min-max-scale_1:
          feature_range_min: 0
          feature_range_max: 1
    outs:
    - path: data/min-max-scaled_1.parquet
      md5: a0c09becc715bf73606533fa457819be
      size: 178615670
    - path: data/min-max-scaler-maxs_1.csv
      md5: 0a25e62d423e0d911e71e06e356c645b
      size: 235
    - path: data/min-max-scaler-mins_1.csv
      md5: ee653e891de3e515d7f95173e7ca1988
      size: 226
  fft_1:
    cmd: python src/fft.py fft_1 data/segmentate_1.dill data/fft_1.dill
    deps:
    - path: data/segmentate_1.dill
      md5: f3c8c1ee0cfa27e9d18b2fd563c2ff2f
      size: 142338896
    - path: src/fft.py
      md5: 35519ab266a5f3df49ab5b9b76c02f72
      size: 1603
    outs:
    - path: data/fft_1.dill
      md5: de59436d33ec1d945e9edfcce452a731
      size: 57579607
  aggregate_1:
    cmd: python src/aggregate.py aggregate_1 data/segmentate_1.dill data/aggregate_1.dill
    deps:
    - path: data/segmentate_1.dill
      md5: f3c8c1ee0cfa27e9d18b2fd563c2ff2f
      size: 142338896
    - path: src/aggregate.py
      md5: 41b070d706fc5ce1ac7a1364f5c9e681
      size: 1691
    params:
      params.yaml:
        aggregate_1:
        - mean
        - median
        - std
    outs:
    - path: data/aggregate_1.dill
      md5: fdb48e2a5963e4ecca9d4a5d8ccb2e02
      size: 5910376
  filter_highpass_1:
    cmd: python src/butterworth_filter.py filter_highpass_1 data/segmentate_1.dill
      data/highpass_1.dill
    deps:
    - path: data/segmentate_1.dill
      md5: f3c8c1ee0cfa27e9d18b2fd563c2ff2f
      size: 142338896
    - path: src/butterworth_filter.py
      md5: 8e474d21e9a43e5b53f60f582fb99bed
      size: 1247
    - path: src/utils/filters.py
      md5: 21ff1b24705d58d1cd747903ed4b23e1
      size: 1978
    params:
      params.yaml:
        filter_highpass_1:
          filter_type: highpass
          order: 3
          cutoff_f_Hz: 0.1
    outs:
    - path: data/highpass_1.dill
      md5: c3fa48964d1e39fed09f09f080f8ddef
      size: 223395383
  pca_1:
    cmd: python src/pca.py pca_1 data/resample_1.parquet data/pca_1.parquet
    deps:
    - path: data/resample_1.parquet
      md5: a967aa3c39663152db3c44fd6c906492
      size: 88337427
    - path: src/pca.py
      md5: a213dfb3e16a73e1666abb2e72fd16d7
      size: 1180
    params:
      params.yaml:
        pca_1:
          n_components: 6
    outs:
    - path: data/pca_1.parquet
      md5: a329dd4e9ece6265516a227def0d3ce6
      size: 67273461
