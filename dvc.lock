schema: '2.0'
stages:
  pull_data:
    cmd: python src/pull_data.py data/db_pull_calibrated.parquet data/db_pull_uncalibrated.parquet
    deps:
    - path: src/pull_data.py
      md5: 47d3bcadedf1f9db0bca7597375c6e22
      size: 1432
    - path: src/utils/dbconnector.py
      md5: 7d87ce109d5d15d6ae8b4c4367bc2271
      size: 1547
    params:
      params.yaml:
        database.questdb:
          table_name: prod
          host: docker.great-squeaker.ts.net
          port: 9000
    outs:
    - path: data/db_pull_calibrated.parquet
      md5: d30e256f1a00d82ece6f07422261055a
      size: 135521717
    - path: data/db_pull_uncalibrated.parquet
      md5: b63f1578c5b0cc51b5aafcfb09a00458
      size: 128520845
  resample:
    cmd: python src/resample.py data/db_pull_calibrated.parquet 50 linear
    deps:
    - path: data/db_pull_calibrated.parquet
      md5: d30e256f1a00d82ece6f07422261055a
      size: 135521717
    - path: src/resample.py
      md5: 69a6d5f6f27c941aa0e80ede9e597592
      size: 960
    outs:
    - path: data/resample.parquet
      md5: a967aa3c39663152db3c44fd6c906492
      size: 88337427
  pca:
    cmd: python src/pca.py data/resample.parquet 6
    deps:
    - path: data/resample.parquet
      md5: a967aa3c39663152db3c44fd6c906492
      size: 88337427
    - path: src/pca.py
      md5: fa8774263d82bc518a08bc55e10aeb20
      size: 1034
    outs:
    - path: data/pca.parquet
      md5: 37eb3137e4a4b425ed208da8b647a0de
      size: 67273332
  segmentate:
    cmd: python src/segmentate.py data/resample.parquet 5 0
    deps:
    - path: data/resample.parquet
      md5: a967aa3c39663152db3c44fd6c906492
      size: 88337427
    - path: src/segmentate.py
      md5: e1abf0000b04bea2cdcb6685ff62fc3a
      size: 1959
    outs:
    - path: data/segmentate.dill
      md5: 59c7cf3230d74ecc1aaebba0757b0bd2
      size: 124896710
  filter_lowpass:
    cmd: python src/butterworth_filter.py data/segmentate.dill lowpass data/lowpass.dill
    deps:
    - path: data/segmentate.dill
      md5: 59c7cf3230d74ecc1aaebba0757b0bd2
      size: 124896710
    - path: src/butterworth_filter.py
      md5: 0b6b9108efd07697f2faf539688f6b98
      size: 1250
    - path: src/utils/filters.py
      md5: 21ff1b24705d58d1cd747903ed4b23e1
      size: 1978
    params:
      params.yaml:
        filters.lowpass:
          cutoff_f_Hz: 100
          order: 3
    outs:
    - path: data/lowpass.dill
      md5: 475398f949dc27c3b296c28114d3edd2
      size: 205869032
  filter_highpass:
    cmd: python src/butterworth_filter.py data/segmentate.dill highpass data/highpass.dill
    deps:
    - path: data/segmentate.dill
      md5: 59c7cf3230d74ecc1aaebba0757b0bd2
      size: 124896710
    - path: src/butterworth_filter.py
      md5: 0b6b9108efd07697f2faf539688f6b98
      size: 1250
    - path: src/utils/filters.py
      md5: 21ff1b24705d58d1cd747903ed4b23e1
      size: 1978
    params:
      params.yaml:
        filters.highpass:
          cutoff_f_Hz: 0.1
          order: 3
    outs:
    - path: data/highpass.dill
      md5: 7b1cc4a0355612e1b66d0842fa0b5bc6
      size: 205869032
  fft:
    cmd: python src/fft.py data/segmentate.dill data/fft.dill
    deps:
    - path: data/segmentate.dill
      md5: 59c7cf3230d74ecc1aaebba0757b0bd2
      size: 124896710
    - path: src/fft.py
      md5: b318a9bf6a772ff5feed765e562233f7
      size: 1576
    outs:
    - path: data/fft.dill
      md5: 9236e385eb57d1aa51aa084c879ced97
      size: 48578939
  moving_average:
    cmd: python src/moving_average.py data/resample.parquet data/moving_average.parquet
    deps:
    - path: data/resample.parquet
      md5: a967aa3c39663152db3c44fd6c906492
      size: 88337427
    - path: src/moving_average.py
      md5: 33a90e13daee9322ddc9c55842b4a134
      size: 1532
    params:
      params.yaml:
        moving_average.window_len_s: 0.5
    outs:
    - path: data/moving_average.parquet
      md5: 021e41268323658f66ffd048183ec814
      size: 138287096
  filter_bandpass:
    cmd: python src/butterworth_filter.py data/segmentate.dill bandpass data/bandpass.dill
    deps:
    - path: data/segmentate.dill
      md5: 59c7cf3230d74ecc1aaebba0757b0bd2
      size: 124896710
    - path: src/butterworth_filter.py
      md5: 0b6b9108efd07697f2faf539688f6b98
      size: 1250
    - path: src/utils/filters.py
      md5: 21ff1b24705d58d1cd747903ed4b23e1
      size: 1978
    params:
      params.yaml:
        filters.bandpass:
          lowcut_f_Hz: 0.1
          highcut_f_Hz: 100
          order: 3
    outs:
    - path: data/bandpass.dill
      md5: 24b510a0ba20c83dc9cbbb12e88445c6
      size: 205869032
