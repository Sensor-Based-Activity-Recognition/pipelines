schema: '2.0'
stages:
  pull_data:
    cmd: python src/pull_data.py data/db_pull_calibrated.parquet data/db_pull_uncalibrated.parquet
    deps:
    - path: src/pull_data.py
      md5: 47d3bcadedf1f9db0bca7597375c6e22
      size: 1432
    - path: src/utils/dbconnector.py
      md5: 7d87ce109d5d15d6ae8b4c4367bc2271
      size: 1547
    params:
      params.yaml:
        database.questdb:
          table_name: prod
          host: docker.great-squeaker.ts.net
          port: 9000
    outs:
    - path: data/db_pull_calibrated.parquet
      md5: d30e256f1a00d82ece6f07422261055a
      size: 135521717
    - path: data/db_pull_uncalibrated.parquet
      md5: b63f1578c5b0cc51b5aafcfb09a00458
      size: 128520845
  resample:
    cmd: python src/resample.py data/db_pull_calibrated.parquet 50 linear
    deps:
    - path: data/db_pull_calibrated.parquet
      md5: d30e256f1a00d82ece6f07422261055a
      size: 135521717
    - path: src/resample.py
      md5: b7209f9cdddb487741e34bd5da854a91
      size: 1124
    outs:
    - path: data/resample.parquet
      md5: d826ddc6fce7ed18fc75294100e35f01
      size: 88337427
  pca:
    cmd: python src/pca.py data/resample.parquet 6
    deps:
    - path: data/resample.parquet
      md5: d826ddc6fce7ed18fc75294100e35f01
      size: 88337427
    - path: src/pca.py
      md5: fa8774263d82bc518a08bc55e10aeb20
      size: 995
    outs:
    - path: data/pca.parquet
      md5: 7d1534ac710c7fe62827a162a2648ee3
      size: 67273779
  segmentate:
    cmd: python src/segmentate.py data/resample.parquet 5 0
    deps:
    - path: data/resample.parquet
      md5: d826ddc6fce7ed18fc75294100e35f01
      size: 88337427
    - path: src/segmentate.py
        md5: 637d6890bb0ac46bc3abede3e5fdd081
        size: 2165
      outs:
      - path: data/segmentate.dill
        md5: f3c8c1ee0cfa27e9d18b2fd563c2ff2f
        size: 142338896
  min-max-scale:
    cmd: python src/min-max-scaler.py data/db_pull_calibrated.parquet 0 1
    deps:
    - path: data/db_pull_calibrated.parquet
      md5: d30e256f1a00d82ece6f07422261055a
      size: 135521717
    - path: src/min-max-scaler.py
      md5: 5bb3a554706c820a21876bbc05ed8614
      size: 802
    outs:
    - path: data/min-max-scaled.parquet
      md5: eac47ce9c3e09ad12163d8defca94ae6
      size: 178615670
    - path: data/min-max-scaler-maxs.csv
      md5: ee653e891de3e515d7f95173e7ca1988
      size: 217
    - path: data/min-max-scaler-mins.csv
      md5: 0a25e62d423e0d911e71e06e356c645b
      size: 226
  std-scale:
    cmd: python src/standard-scaler.py data/db_pull_calibrated.parquet
    deps:
    - path: data/db_pull_calibrated.parquet
      md5: d30e256f1a00d82ece6f07422261055a
      size: 135521717
    - path: src/standard-scaler.py
      md5: 59b38244e5c5a9c162b5fbbe57dcd50c
      size: 574
    outs:
    - path: data/standard-scaled.parquet
      md5: 2e8c6c80ef9f14d5a905f4ee212a1d94
      size: 183757076
    - path: data/standard-scaler-means.csv
      md5: 960c8974f6ff21fee6dfbc4d99e2d4aa
      size: 234
    - path: data/standard-scaler-stds.csv
      md5: 6c408758b4d89b446bde0f388c7c3b4e
      size: 217
  aggregate:
    cmd: python src/aggregate.py data/segmentate.dill data/aggregate.dill
    deps:
    - path: data/segmentate.dill
      md5: f3c8c1ee0cfa27e9d18b2fd563c2ff2f
      size: 142338896
    - path: src/aggregate.py
      md5: a69b8e9921d72ec848189b7d5f090e4f
      size: 1661
    params:
      params.yaml:
        aggregate:
        - mean
        - median
        - std
    outs:
    - path: data/aggregate.dill
      md5: 8811041962028ac7950e1f05697715d0
      size: 5478173
  filter_lowpass:
    cmd: python src/butterworth_filter.py data/segmentate.dill lowpass data/lowpass.dill
    deps:
    - path: data/segmentate.dill
      md5: f3c8c1ee0cfa27e9d18b2fd563c2ff2f
      size: 142338896
    - path: src/butterworth_filter.py
      md5: 0b6b9108efd07697f2faf539688f6b98
      size: 1250
    - path: src/utils/filters.py
      md5: 21ff1b24705d58d1cd747903ed4b23e1
      size: 1978
    params:
      params.yaml:
        filters.lowpass:
          cutoff_f_Hz: 100
          order: 3
    outs:
    - path: data/lowpass.dill
      md5: 1c878af7c6895936cba61c5b8b09ae73
      size: 223395417
  moving_average:
    cmd: python src/moving_average.py data/resample.parquet data/moving_average.parquet
    deps:
    - path: data/resample.parquet
      md5: d826ddc6fce7ed18fc75294100e35f01
      size: 88337427
    - path: src/moving_average.py
      md5: 33a90e13daee9322ddc9c55842b4a134
      size: 1490
    params:
      params.yaml:
        moving_average.window_len_s: 0.5
    outs:
    - path: data/moving_average.parquet
      md5: a2b9e70476b32ad3c333211be08df237
      size: 138287096
  filter_bandpass:
    cmd: python src/butterworth_filter.py data/segmentate.dill bandpass data/bandpass.dill
    deps:
    - path: data/segmentate.dill
      md5: f3c8c1ee0cfa27e9d18b2fd563c2ff2f
      size: 142338896
    - path: src/butterworth_filter.py
      md5: 0b6b9108efd07697f2faf539688f6b98
      size: 1250
    - path: src/utils/filters.py
      md5: 21ff1b24705d58d1cd747903ed4b23e1
      size: 1978
    params:
      params.yaml:
        filters.bandpass:
          lowcut_f_Hz: 0.1
          highcut_f_Hz: 100
          order: 3
    outs:
    - path: data/bandpass.dill
      md5: d0061751feec4c110d120040e086477e
      size: 223395417
  correlations:
    cmd: python src/correlations.py data/segmentate.dill data/correlations.parquet
      pearson
    deps:
    - path: data/segmentate.dill
      md5: f3c8c1ee0cfa27e9d18b2fd563c2ff2f
      size: 142338896
    - path: src/correlations.py
      md5: d054e4a6858b0cccb2d419f62552dd5e
      size: 1930
    outs:
    - path: data/correlations.parquet
      md5: 7e66f193a3057426e2f0b14d3c72e42a
      size: 6067695
  train_test_split:
    cmd: python src/train_test_split.py data/segmentate.dill data/train_test_split.json
    deps:
    - path: data/segmentate.dill
      md5: f3c8c1ee0cfa27e9d18b2fd563c2ff2f
      size: 142338896
    - path: src/train_test_split.py
      md5: 94d67eaa3fad9cbf073cfda7c3327ee2
      size: 2713
    params:
      params.yaml:
        train_test_split:
          type: person
          test_ratio: 0.2
          seed: 9458
          stratified: true
    outs:
    - path: data/train_test_split.json
      md5: 20a5446519af97f135682be727731a9f
      size: 49755
  fft:
    cmd: python src/fft.py data/segmentate.dill data/fft.dill
    deps:
    - path: data/segmentate.dill
      md5: f3c8c1ee0cfa27e9d18b2fd563c2ff2f
      size: 142338896
    - path: src/fft.py
      md5: b318a9bf6a772ff5feed765e562233f7
      size: 1576
    outs:
    - path: data/fft.dill
      md5: de59436d33ec1d945e9edfcce452a731
      size: 57579607
  filter_highpass:
    cmd: python src/butterworth_filter.py data/segmentate.dill highpass data/highpass.dill
    deps:
    - path: data/segmentate.dill
      md5: f3c8c1ee0cfa27e9d18b2fd563c2ff2f
      size: 142338896
    - path: src/butterworth_filter.py
      md5: 0b6b9108efd07697f2faf539688f6b98
      size: 1250
    - path: src/utils/filters.py
      md5: 21ff1b24705d58d1cd747903ed4b23e1
      size: 1978
    params:
      params.yaml:
        filters.highpass:
          cutoff_f_Hz: 0.1
          order: 3
    outs:
    - path: data/highpass.dill
      md5: be1873f5e58b84cc7d1495bc32c14e0f
      size: 223395417